\section{Numerical Schemes}

The coefficients of equation~\eqref{eqn:num:dap} must remain positive
since an increase in a neighboring value must result in an increase
in $\phi_P$, to obtain physically realistic solutions. Also the
coefficients of equation~\eqref{eqn:num:dis}, when written in the form
of equation~\eqref{eqn:num:dap}, must remain positive. Thus the
inequalities, $a_{nb} > 0$ and $a_{nb} - F_f>0$, must be satisfied.  If,
$P_f = -F_f / D_f$, then to achieve physically realistic solutions the
following inequality must be satisfied,
\begin{equation}
\frac{1}{1-\alpha_f} > P_f > -\frac{1}{\alpha_f}
\label{eqn:num:inq}
\end{equation}
The parameter, $\alpha_f$, is defined by the chosen scheme depending
on Equation~\eqref{eqn:num:inq}. The value, $P_f$, is the ratio between
convective strength and diffusive conductance. The various
differencing schemes are:
\begin{itemize}
%
%
%
\item The central differencing scheme,
\begin{equation}
\alpha_f = \frac{d_{Af}}{d_{Af}+d_{fP}}
\label{eqn:num:cds}
\end{equation}
In many circumstances with a structured mesh, $\alpha_f=1/2$ so that,
$|P_f|<2$ satisfies Equation~\eqref{eqn:num:inq}.  Thus the central
differencing scheme is only numerically stable for a low values of
$P_f$.
%
%
%
\item The upwind Scheme,
\begin{eqnarray}
\alpha_f = 1 & \mbox{if} & P_f > 0 \\
\alpha_f = 0 & \mbox{if} & P_f < 0 
\label{eqn:num:ups}
\end{eqnarray}
Equation~\eqref{eqn:num:ups} satisfies the inequality in
Equation~\eqref{eqn:num:inq} for all values of $P_f$.  However the
solution over predicts the diffusive term leading to excessive
numerical smearing (False Diffusion).
%
%
%
\item The exponential scheme,
\begin{equation}
\alpha_f = \frac{(P_f-1)\exp{(P_f)}+1}{P_f(\exp{(P_f)}-1)}
\label{eqn:num:exs}
\end{equation}
This formulation can be derived from the exact solution, and thus,
guarantees positive coefficients while not over predicting the
diffusive terms. However the computation of exponentials is slow and
therefore a faster scheme is generally used, especially in higher
dimensions.
%
%
%
\item The hybrid scheme,
\begin{eqnarray}
\alpha_f = \frac{P_f-1}{P_f} & \mbox{if} & P_f > 2 \\
\alpha_f = \frac{1}{2} & \mbox{if} & |P_f| < 2 \\
\alpha_f = -\frac{1}{P_f} & \mbox{if} & P_f < -2
\label{eqn:num:hys}
\end{eqnarray}
The hybrid scheme is formulated by allowing $P_f \rightarrow \infty$,
$P_f \rightarrow 0$ and $P_f \rightarrow -\infty$ in the exponential
scheme.  The hybrid scheme is an improvement on the upwind scheme,
however it deviates from the exponential scheme at $|P_f|=2$.
%
%
%
\item The power law scheme,
\begin{eqnarray}
\alpha_f = \frac{P_f-1}{P_f} & \mbox{if} & P_f > 10 \\
\alpha_f = \frac{(P_f-1)+(1-P/10)^5}{P_f} & \mbox{if} & 0 < P_f < 10 \\
\alpha_f = \frac{(1-P_f/10)^5 - 1}{P_f} & \mbox{if} & -10 < P_f < 0 \\
\alpha_f = -\frac{1}{P_f} & \mbox{if} & P_f < -10
\label{eqn:num:pls}
\end{eqnarray}
The power law scheme overcomes the inaccuracies of the hybrid scheme
while improving on the computational time for the exponential scheme.
\end{itemize}

All of the numerical schemes presented here are implemented in \FiPy{}.







