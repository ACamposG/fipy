\section{Numerical Schemes}

The coefficients of equation~\eqref{eqn:num:dap} must remain positive,
since an increase in a neighboring value must result in an increase in
$\phi_P$ to obtain physically realistic solutions.  Thus, the
inequalities $a_A > 0$ and $a_A - F_f>0$ must be satisfied.  The
P\'{e}clet number $P_f \equiv -F_f / D_f$ is the ratio between convective
strength and diffusive conductance.  To achieve physically realistic
solutions, the inequality
\begin{equation}
\frac{1}{1-\alpha_f} > P_f > -\frac{1}{\alpha_f}
\label{eqn:num:inq}
\end{equation}
must be satisfied.
The parameter $\alpha_f$ is defined by the chosen scheme, depending
on Equation~\eqref{eqn:num:inq}. The various
differencing schemes are:
\begin{description}
%
%
%
\item[the central differencing scheme,] where
\begin{equation}
\alpha_f = \frac{d_{Af}}{d_{Af}+d_{fP}}.
\label{eqn:num:cds}
\end{equation}
In many circumstances with a structured mesh, $\alpha_f=1/2$, so that
$|P_f|<2$ satisfies Equation~\eqref{eqn:num:inq}.  Thus, the central
differencing scheme is only numerically stable for a low values of
$P_f$.
%
%
%
\item[the upwind scheme,] where
\begin{eqnarray}
\alpha_f = \begin{cases}
1 & \text{if $P_f > 0$,} \\
0 & \text{if $ P_f < 0$.}
\end{cases}
\label{eqn:num:ups}
\end{eqnarray}
Equation~\eqref{eqn:num:ups} satisfies the inequality in
Equation~\eqref{eqn:num:inq} for all values of $P_f$.  However the
solution over predicts the diffusive term leading to excessive
numerical smearing (``false diffusion'').
%
%
%
\item[the exponential scheme,] where
\begin{equation}
\alpha_f = \frac{(P_f-1)\exp{(P_f)}+1}{P_f(\exp{(P_f)}-1)}.
\label{eqn:num:exs}
\end{equation}
This formulation can be derived from the exact solution, and thus,
guarantees positive coefficients while not over-predicting the
diffusive terms. However, the computation of exponentials is slow and
therefore a faster scheme is generally used, especially in higher
dimensions.
%
%
%
\item[the hybrid scheme,] where
\begin{eqnarray}
\alpha_f = 
\begin{cases}
    \frac{P_f-1}{P_f} & \text{if $P_f > 2$,} \\
    \frac{1}{2} & \text{if $|P_f| < 2$,} \\
    -\frac{1}{P_f} & \text{if $P_f < -2$.}
\end{cases}
\label{eqn:num:hys}
\end{eqnarray}
The hybrid scheme is formulated by allowing $P_f \rightarrow \infty$,
$P_f \rightarrow 0$ and $P_f \rightarrow -\infty$ in the exponential
scheme.  The hybrid scheme is an improvement on the upwind scheme,
however, it deviates from the exponential scheme at $|P_f|=2$.
%
%
%
\item[the power law scheme,] where
\begin{eqnarray}
\alpha_f = 
\begin{cases}
    \frac{P_f-1}{P_f} & \text{if $P_f > 10$,} \\
    \frac{(P_f-1)+(1-P_f/10)^5}{P_f} & \text{if $0 < P_f < 10$,} \\
    \frac{(1-P_f/10)^5 - 1}{P_f} & \text{if $-10 < P_f < 0$,} \\
    -\frac{1}{P_f} & \text{if $P_f < -10$.}
\end{cases}
\label{eqn:num:pls}
\end{eqnarray}
The power law scheme overcomes the inaccuracies of the hybrid scheme,
while improving on the computational time for the exponential scheme.
\end{description}

All of the numerical schemes presented here are available in \FiPy{}
and can be selected by the user.







