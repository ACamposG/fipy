%% -*-TeX-*-
 % ###################################################################
 %  FiPy - a finite volume PDE solver in Python
 % 
 %  FILE: "fipy.tex"
 %                                    created: 4/1/04 {2:58:37 PM} 
 %                                last update: 11/1/04 {8:28:27 AM} 
 %  Author: Jonathan Guyer
 %  E-mail: guyer@nist.gov
 %  Author: Daniel Wheeler
 %  E-mail: daniel.wheeler@nist.gov
 %    mail: NIST
 %     www: http://ctcms.nist.gov
 %  
 % ========================================================================
 % This document was prepared at the National Institute of Standards
 % and Technology by employees of the Federal Government in the course
 % of their official duties.  Pursuant to title 17 Section 105 of the
 % United States Code this document is not subject to copyright
 % protection and is in the public domain.  fipy.tex
 % is an experimental work.  NIST assumes no responsibility whatsoever
 % for its use by other parties, and makes no guarantees, expressed
 % or implied, about its quality, reliability, or any other characteristic.
 % We would appreciate acknowledgement if the document is used.
 % 
 % This document can be redistributed and/or modified freely
 % provided that any derivative works bear some notice that they are
 % derived from it, and any modified versions bear some notice that
 % they have been modified.
 % ========================================================================
 % See the file "license.terms" for information on usage and  redistribution of
 % this file, and for a DISCLAIMER OF ALL WARRANTIES.
 %  
 % ###################################################################
 %%

\documentclass[tocAsPDFpart]{fipy}

\begin{document}

\doparttoc

\frontmatter

\title{\FiPy{}}
\subtitle{A Finite Volume PDE Solver Using Python}

\author{Daniel Wheeler \and Jonathan E. Guyer \and James A. Warren}
\affiliation{Metallurgy Division \and
and the Center for Theoretical and Computational Materials Science 
\and Materials Science and Engineering Laboratory}

\maketitle

\vspace*{\fill}

\input license

\rule{\textwidth}{0.1pt}

\input disclaimer

\maxtocdepth{all} 
\tableofcontents
% \faketableofcontents

\mainmatter

%%%%%%%%%%%%%%%%
% I. INTRODUCTION
%%%%%%%%%%%%%%%%

\part{Introduction}

\settocdepth{chapter} 

\renewcommand{\ptctitle}{Introduction Contents}

\parttoc

% Technical Overview

\chapter{Overview}

\inputencoding{latin1}

\input readme  

% Installation

\chapter{Installation and Usage}
\label{chap:Installation}

\inputencoding{latin1}

\input installation

% Numerical

\chapter{Theoretical and Numerical Background}
\label{chap:Numerics}

\inputencoding{ascii}

\input numerical/numerical

% Implementation

\chapter{Design and Implementation}
\label{chap:Design}

\inputencoding{latin1}

\input introduction

% TODO List

% \chapter{Future Work}
% \label{chap:ToDo}
% 
% \inputencoding{latin1}
% 
% \input todolist

%%%%%%%%%%%%%%%%%
% 2. EXAMPLES
%%%%%%%%%%%%%%%%%

\settocdepth{all} 

\sloppy

\part{Examples}
\label{part:Examples}

% \chapter{Usage}
\input{examples/readme}

\settocdepth{chapter} 
\renewcommand{\ptctitle}{Example Contents}
\parttoc

\chapter{Diffusion Examples}

\input{examples/latex/examples.diffusion.steadyState.mesh1D.input-module}
% \newpage
% \input{examples/latex/examples.diffusion.steadyState.mesh1D.tri2Dinput-module}
% \newpage
\input{examples/latex/examples.diffusion.steadyState.mesh20x20.input-module}
% \newpage
% \input{examples/latex/examples.diffusion.steadyState.mesh50x50.input-module}
% \newpage
\input{examples/latex/examples.diffusion.explicit.mesh10.input-module}
% \newpage
% \input{examples/latex/examples.diffusion.explicit.mesh50.input-module}
% \newpage
% \input{examples/latex/examples.diffusion.variable.mesh2x1.input-module}
% \newpage
\input{examples/latex/examples.diffusion.variable.mesh10x1.input-module}
% \newpage
% \input{examples/latex/examples.diffusion.variable.mesh50x1.input-module}
% \newpage
\input{examples/latex/examples.diffusion.nthOrder.input2ndOrder1D-module}
% \newpage
\input{examples/latex/examples.diffusion.nthOrder.input4thOrder1D-module}
% \newpage

\chapter{Convection Examples}

\input{examples/latex/examples.convection.exponential1D.input-module}
% \newpage
% \input{examples/latex/examples.convection.exponential1DBack.input-module}
% \newpage
\input{examples/latex/examples.convection.exponential1DSource.input-module}
% \newpage
% \input{examples/latex/examples.convection.exponential2D.input-module}
% \newpage
% \input{examples/latex/examples.convection.powerLaw1D.input-module}
% \newpage

\chapter{Phase Field Examples}

\section*{Solidification Examples}
% \addstarredsection{Solidification Examples}
\addcontentsline{toc}{section}{Solidification Examples} 

The following examples exhibit various phenomena in solidification, including
dendritic growth and grain impingement.  Further discussion of the
models and algorithms can be found in
reference~\cite{WarrenPolycrystal}.

\input{examples/latex/examples.phase.anisotropy.input-module}
% \newpage
\input{examples/latex/examples.phase.impingement.mesh40x1.input-module}
% \newpage
\input{examples/latex/examples.phase.impingement.mesh20x20.base-module}
% \newpage
\input{examples/latex/examples.phase.impingement.mesh20x20.input-module}
% \newpage
\input{examples/latex/examples.phase.impingement.restart.input-module}
% \newpage
% \input{examples/latex/examples.phase.missOrientation.circle.input-module}
% \newpage
% \input{examples/latex/examples.phase.missOrientation.mesh1D.input-module}
% \newpage
% \input{examples/latex/examples.phase.missOrientation.modCircle.input-module}
\newpage

\section*{Electrochemistry Examples}
% \addstarredsection{Electrochemistry Examples} 
\addcontentsline{toc}{section}{Electrochemistry Examples} 

The following examples exhibit various parts of a model to study
electrochemical interfaces.  In a pair of papers
\cite{ElPhFI,ElPhFII}, Guyer, Boettinger, Warren and McFadden have
shown that an electrochemical interface can be modeled by an equation
for the phase field \( \xi \)

\[
    \underbrace{
	\frac{\partial \xi}{\partial t}
	\vphantom{M_{\xi}\sum_{j=1}^{n} C_j}
    }_{\text{transient}}
    = 
    \underbrace{
	M_{\xi}\kappa_{\xi}\nabla^2 \xi
	\vphantom{M_{\xi}\sum_{j=1}^{n} C_j}
    }_{\text{diffusion}}
    - 
    \underbrace{
	\overbrace{
	    M_{\xi}\sum_{j=1}^{n} C_j \left[
		p'(\xi) \Delta\mu_j^\circ
		+ g'(\xi) W_j
	    \right]
	}^{\text{phase transformation}}
	+
	\overbrace{
	    M_{\xi}\frac{\epsilon'(\xi)}{2}\left(\nabla\phi\right)^2
	}^{\text{dielectric}}
    }_{\text{source}}
\]

a set of diffusion equations for the concentrations \( C_j \), for \(
j = 2,\ldots, n-1 \), of the substitutional elements

\begin{align*}
    \underbrace{
	\frac{\partial C_j}{\partial t}
    }_{\text{transient}}
    &= \underbrace{
	D_{j}\nabla^2 C_j
	\vphantom{\frac{\partial C_j}{\partial t}}
    }_{\text{diffusion}} \\
    & \qquad + \underbrace{
	D_{j}\nabla\cdot 
	\frac{C_j}{1 - \sum_{\substack{k=2\\ k \neq j}}^{n-1} C_k}
	\left\{
	    \overbrace{
		\sum_{\substack{i=2\\ i \neq j}}^{n-1} \nabla C_i
	    }^{\text{counter diffusion}}
	    + 
	    \overbrace{
		C_n \left[
		    p'(\xi) \Delta\mu_{jn}^{\circ}
		    + g'(\xi) W_{jn}
		\right] \nabla\xi
		\vphantom{\sum_{\substack{i=2\\ i \neq j}}^{n-1} \nabla C_i}
	    }^{\text{phase transformation}}
	    +
	    \overbrace{
		C_n z_{jn} \nabla \phi
		\vphantom{\sum_{\substack{i=2\\ i \neq j}}^{n-1} \nabla C_i}
	    }^{\text{electromigration}}
	\right\}
    }_{\text{convection}}
\end{align*}

a diffusion equation for the concentration \( C_{\text{e}^{-}} \) of
electrons

\[
    \underbrace{
	\frac{\partial C_{\text{e}^{-}}}{\partial t}
	\vphantom{\left\{
	    \overbrace{
		\left[p'(\xi)\right]
	    }^{\text{phase transformation}}
	\right\}}
    }_{\text{transient}}
    = \underbrace{
	D_{\text{e}^{-}}\nabla^2 C_{\text{e}^{-}}
	\vphantom{\left\{
	    \overbrace{
		\left[p'(\xi)\right]
	    }^{\text{phase transformation}}
	\right\}}
    }_{\text{diffusion}} \\
    + \underbrace{
	D_{\text{e}^{-}}\nabla\cdot 
	C_{\text{e}^{-}}
	\left\{
	    \overbrace{
		\left[
		    p'(\xi) \Delta\mu_{\text{e}^{-}}^{\circ}
		    + g'(\xi) W_{\text{e}^{-}}
		\right] \nabla\xi
	    }^{\text{phase transformation}}
	    +
	    \overbrace{
		z_{\text{e}^{-}} \nabla \phi
	    }^{\text{electromigration}}
	\right\}
    }_{\text{convection}}
\]

and Poisson's equation for the electrostatic potential \( \psi \)

\[ 
    \underbrace{
	\nabla\cdot\left(\epsilon\nabla\psi\right) 
    }_{\text{diffusion}}
    +
    \underbrace{
	\rho
    }_{\text{source}}
    = 0
\]

\( M_\xi \) is the phase field mobility, \( \kappa_\xi \) is the phase
field gradient energy coefficient, \( p'(\xi) =
30\xi^2\left(1-\xi\right)^2 \), and \( g'(\xi) =
2\xi\left(1-\xi\right)\left(1-2\xi\right) \).  For a given species \(
j \), \( \Delta\mu_j^{\circ} \) is the standard chemical potential
difference between the electrode and electrolyte for a pure material,
\( W_j \) is the magnitude of the energy barrier in the double-well
free energy function, \( z_j \) is the valence, and \( D_{j} \) is the
self diffusivity.  \( \Delta\mu_{jn}^{\circ} \), \( W_{jn} \), and \(
z_{jn} \) are the differences of the respective quantities \(
\Delta\mu_{j}^{\circ} \), \( W_{j} \), and \( z_{j} \) between
substitutional species \( j \) and the solvent species \( n \).  The
total charge is denoted by \( \rho \equiv \sum_{j=1}^n z_j C_j \).

The module \verb+fipy.models.elphf+ has been developed to solve this
coupled set of equations.  Although unresolved stiffnesses make the
full solution intractable in \FiPy{}, we can demonstrate the use of
various parts of the \verb+elphf+ module.

\input{examples/latex/examples.elphf.input1Dphase-module}
% \newpage
\input{examples/latex/examples.elphf.input1D-module}
% \newpage
\input{examples/latex/examples.elphf.input1Ddimensional-module}
% \newpage
% \input{examples/latex/examples.elphf.input2D-module}
% \newpage
% \input{examples/latex/examples.elphf.input2Dcorner-module}
% \newpage
% \input{examples/latex/examples.elphf.input1DpoissonAllCharge-module}
% \newpage
% \input{examples/latex/examples.elphf.input1DpoissonLeftCharge-module}
% \newpage
\input{examples/latex/examples.elphf.input1DpoissonRightCharge-module}
% \newpage
\input{examples/latex/examples.elphf.input1DphaseBinary-module}
% \newpage
% \input{examples/latex/examples.elphf.input1DphaseQuaternary-module}
% \newpage
\input{examples/latex/examples.elphf.input1DphaseTernAndElectrons-module}
% \newpage


\chapter{Level Set Examples}

\input{examples/latex/examples.levelSet.distanceFunction.oneD.input-module}
% \newpage
% \input{examples/latex/examples.levelSet.distanceFunction.square.input-module}
% \newpage
\input{examples/latex/examples.levelSet.distanceFunction.circle.input-module}
% \newpage
% \input{examples/latex/examples.levelSet.distanceFunction.interior.input-module}
% \newpage
\input{examples/latex/examples.levelSet.advection.mesh1D.input-module}
% \newpage
\input{examples/latex/examples.levelSet.advection.circle.input-module}
% \newpage

\chapter{Cahn-Hilliard Examples}

\input{examples/latex/examples.cahnHilliard.inputTanh1D-module}
% \newpage

\settocdepth{all} 

\backmatter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%                                 Index                                 %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\fussy

% \bibliographystyle{unsrt_no_title}
\bibliographystyle{fipy}
\bibliography{refs}

\printindex

\appendix 

% Credits

\chapter*{Contributors}
% \addstarredpart{Contributors} 
\addcontentsline{toc}{part}{Contributors} 
\label{chap:Contributors}

\inputencoding{latin1}

\input credits

\end{document}
